{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "array",
  "title": "Metabase Dashboard Parameters",
  "description": "Array of parameter objects for Metabase dashboard configuration. Parameters allow dynamic filtering and customization of dashboard cards.",
  "items": {
    "type": "object",
    "title": "Parameter",
    "description": "A single parameter configuration object",
    "properties": {
      "id": {
        "type": "string",
        "description": "Unique identifier for the parameter. This is auto-generated by Metabase using a random 8-character hexadecimal string. When creating new parameters, leave this field empty or omit it entirely - Metabase will generate a unique ID automatically. Do not invent or manually specify IDs.",
        "pattern": "^[a-f0-9]{8}$",
        "examples": ["eab1cc0e", "1545f023", "fa3f29d7", "2cc12bf", "39cd2a3f"]
      },
      "name": {
        "type": "string",
        "description": "Human-readable name for the parameter, displayed in the dashboard UI. Cannot be empty and cannot be 'tab' (reserved for dashboard tabs).",
        "minLength": 1,
        "maxLength": 100,
        "not": {
          "const": "tab"
        },
        "examples": [
          "Evolution Date Filter",
          "Date Granularity",
          "Campaign Type",
          "Office",
          "Campaign Name Contains"
        ]
      },
      "display-name": {
        "type": "string",
        "description": "Optional display name that overrides the name in certain UI contexts",
        "minLength": 1,
        "maxLength": 100
      },
      "type": {
        "type": "string",
        "description": "The parameter type determining how the parameter behaves and what values it accepts",
        "enum": [
          "date/all-options",
          "date/single",
          "date/range",
          "date/relative",
          "date/month-year",
          "date/quarter-year",
          "string/=",
          "string/!=",
          "string/contains",
          "string/does-not-contain",
          "string/starts-with",
          "string/ends-with",
          "number/=",
          "number/!=",
          "number/between",
          "number/>=",
          "number/<=",
          "id",
          "category",
          "location",
          "temporal-unit"
        ],
        "examples": [
          "date/all-options",
          "string/=",
          "string/contains",
          "number/between",
          "boolean/="
        ]
      },

      "sectionId": {
        "type": "string",
        "description": "Category/section for organizing parameters in the dashboard UI. Determines which parameter creation section the parameter belongs to.",
        "enum": [
          "date",
          "temporal-unit",
          "location", 
          "string",
          "number",
          "id"
        ],
        "examples": ["date", "string", "number", "location"]
      },
      "default": {
        "description": "Default value(s) for the parameter. The type depends on the parameter type and isMultiSelect setting. For date parameters, common values include relative date strings.",
        "oneOf": [
          {
            "type": "string",
            "description": "Single default value (for non-multiselect parameters or date parameters)",
            "examples": ["past4weeks", "past7days", "month", "thisday", "past1days", "past30days", "thisweek", "thismonth", "thisyear"]
          },
          {
            "type": "number",
            "description": "Single numeric default value"
          },
          {
            "type": "boolean",
            "description": "Single boolean default value"
          },
          {
            "type": "array",
            "description": "Array of default values (for multiselect parameters)",
            "items": {
              "oneOf": [
                {"type": "string"},
                {"type": "number"},
                {"type": "boolean"}
              ]
            },
            "examples": [
              ["Campaign Type: Prospecting"],
              ["week"],
              ["Campaign Type: Branded", "Campaign Type: Non Branded"]
            ]
          },
          {
            "type": "null",
            "description": "No default value"
          }
        ]
      },
      "isMultiSelect": {
        "type": "boolean",
        "description": "Whether the parameter allows multiple values to be selected. Only applicable for certain parameter types (string/=, string/!=, string/contains, string/does-not-contain, string/starts-with, string/ends-with, number/=, number/!=, category, id, location). Defaults to true for applicable string parameters if not specified.",
        "default": true,
        "examples": [true, false]
      },
      "values_query_type": {
        "type": "string",
        "description": "How parameter values are populated for the UI widget",
        "enum": [
          "list",
          "search",
          "none"
        ],
        "examples": ["list", "search", "none"]
      },
      "values_source_type": {
        "type": ["string", "null"],
        "description": "Source type for parameter values",
        "enum": [
          null,
          "card",
          "static-list"
        ],
        "examples": [null, "card", "static-list"]
      },
      "values_source_config": {
        "type": "object",
        "description": "Configuration for parameter value sources",
        "properties": {
          "values": {
            "type": "array",
            "description": "Static list of values for the parameter",
            "items": {
              "oneOf": [
                {"type": "string"},
                {"type": "number"},
                {"type": "boolean"},
                {
                  "type": "array",
                  "description": "Value with optional display label [value, label]",
                  "minItems": 1,
                  "maxItems": 2,
                  "items": {"type": "string"}
                }
              ]
            }
          },
          "card_id": {
            "type": "integer",
            "description": "ID of the card/question to use as value source"
          },
          "value_field": {
            "type": "array",
            "description": "Field reference for the value column from the source card"
          }
        },
        "additionalProperties": false
      },
      "required": {
        "type": "boolean",
        "description": "Whether the parameter is required to have a value. When true, the parameter must have a non-empty default value or the user must provide a value.",
        "default": false,
        "examples": [true, false]
      },
      "options": {
        "type": "object",
        "description": "Additional parameter options for fine-tuning parameter behavior",
        "properties": {
          "case-sensitive": {
            "type": "boolean",
            "description": "Whether string comparisons should be case-sensitive (for string parameter types)"
          }
        },
        "additionalProperties": false
      },
      "filteringParameters": {
        "type": "array",
        "description": "Array of parameter IDs that this parameter depends on for linked filtering. Used to create cascading filter relationships where one parameter's values are filtered based on another parameter's selection.",
        "items": {
          "type": "string",
          "pattern": "^[a-f0-9]{8}$"
        }
      },
      "value": {
        "description": "Current value of the parameter (runtime state, not typically used in configuration)",
        "oneOf": [
          {"type": "string"},
          {"type": "number"},
          {"type": "boolean"},
          {"type": "array"},
          {"type": "null"}
        ]
      },
      "target": {
        "description": "Target mapping for the parameter (used internally by Metabase for connecting parameters to cards)",
        "oneOf": [
          {
            "type": "array",
            "description": "Parameter target reference array"
          },
          {
            "type": "object",
            "description": "Parameter target object"
          }
        ]
      },
      "temporal_units": {
        "type": "array",
        "description": "Available temporal units for temporal-unit parameters. Only applies when type is 'temporal-unit'.",
        "items": {
          "type": "string",
          "enum": [
            "minute",
            "hour", 
            "day",
            "week",
            "month",
            "quarter",
            "year"
          ]
        },
        "examples": [["day", "week", "month", "quarter", "year"]]
      }
    },
    "required": [
      "name",
      "type"
    ],
    "additionalProperties": false,
    "allOf": [
      {
        "if": {
          "properties": {
            "type": {"const": "temporal-unit"}
          }
        },
        "then": {
          "properties": {
            "sectionId": {"const": "temporal-unit"},
            "temporal_units": {
              "type": "array",
              "minItems": 1
            }
          }
        }
      },
      {
        "if": {
          "properties": {
            "required": {"const": true}
          }
        },
        "then": {
          "anyOf": [
            {
              "properties": {
                "default": {
                  "not": {
                    "oneOf": [
                      {"type": "null"},
                      {"const": ""},
                      {"type": "array", "maxItems": 0}
                    ]
                  }
                }
              }
            }
          ]
        }
      },
      {
        "if": {
          "properties": {
            "type": {
              "enum": ["string/contains", "string/does-not-contain", "string/starts-with", "string/ends-with"]
            }
          }
        },
        "then": {
          "properties": {
            "isMultiSelect": {"const": false}
          }
        }
      }
    ],
    "examples": [
      {
        "default": "past4weeks",
        "id": "eab1cc0e",
        "name": "Evolution Date Filter",
        "sectionId": "date",
        "type": "date/all-options"
      },
      {
        "default": ["week"],
        "id": "fa3f29d7",
        "name": "Date Granularity",
        "sectionId": "string",
        "type": "string/=",
        "isMultiSelect": false
      },
      {
        "default": ["Campaign Type: Prospecting"],
        "id": "39cd2a3f",
        "name": "Prospecting",
        "sectionId": "string",
        "type": "string/="
      },
      {
        "id": "a53c1813",
        "name": "Campaign",
        "sectionId": "string",
        "type": "string/="
      },
      {
        "id": "a16a504e",
        "isMultiSelect": true,
        "name": "Office",
        "sectionId": "string",
        "type": "string/=",
        "values_query_type": "list"
      },
      {
        "id": "dd698da1",
        "name": "Campaign Name Contains",
        "sectionId": "string",
        "type": "string/contains",
        "isMultiSelect": false
      },
      {
        "id": "53f490d0",
        "name": "CPA Threshold",
        "sectionId": "number",
        "type": "number/>=",
        "default": 50
      },
      {
        "id": "temporal1",
        "name": "Time Unit",
        "sectionId": "temporal-unit",
        "type": "temporal-unit",
        "temporal_units": ["day", "week", "month", "quarter", "year"]
      }
    ]
  },
  "examples": [
    [
      {
        "default": "past4weeks",
        "id": "1545f023",
        "name": "Evolution Date Filter",
        "sectionId": "date",
        "type": "date/all-options"
      },
      {
        "default": ["week"],
        "id": "fa3f29d7",
        "name": "Date Granularity",
        "sectionId": "string",
        "type": "string/=",
        "isMultiSelect": false
      },
      {
        "default": "past7days",
        "id": "2cc12bf",
        "name": "Scoring Date Filter",
        "sectionId": "date",
        "type": "date/all-options"
      },
      {
        "default": ["Campaign Type: Prospecting"],
        "id": "39cd2a3f",
        "name": "Prospecting",
        "sectionId": "string",
        "type": "string/="
      },
      {
        "default": ["Campaign Type: Retargeting"],
        "id": "b27caaea",
        "name": "Retargeting",
        "sectionId": "string",
        "type": "string/="
      },
      {
        "id": "1e1899c2",
        "name": "Campaign",
        "sectionId": "string",
        "type": "string/="
      }
    ]
  ]
}